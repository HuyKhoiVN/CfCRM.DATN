@{
    Layout = "_Admin_Layout";
}
<!-- ApexCharts CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.css">

<style>
    :root {
        --primary: #4361ee;
        --primary-light: #4895ef;
        --primary-dark: #3f37c9;
        --secondary: #f72585;
        --success: #4cc9f0;
        --warning: #f8961e;
        --danger: #f94144;
        --info: #90e0ef;
        --light: #f8f9fa;
        --dark: #212529;
        --gray-100: #f8f9fa;
        --gray-200: #e9ecef;
        --gray-300: #dee2e6;
        --gray-400: #ced4da;
        --gray-500: #adb5bd;
        --gray-600: #6c757d;
        --gray-700: #495057;
        --gray-800: #343a40;
        --gray-900: #212529;
        --border-radius: 0.5rem;
        --box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        --transition: all 0.3s ease;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f5f7fb;
        color: var(--gray-800);
        min-height: 100vh;
    }

    /* Dashboard Layout */
    .dashboard-container {
        padding: 1.5rem;
    }

    .dashboard-header {
        margin-bottom: 1.5rem;
    }

    .dashboard-title {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--gray-900);
        margin-bottom: 0.5rem;
    }

    .dashboard-subtitle {
        font-size: 1rem;
        color: var(--gray-600);
    }

    /* Stats Cards */
    .stats-cards {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
        gap: 1.5rem;
        margin-bottom: 1.5rem;
    }

    .stat-card {
        background-color: #fff;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        padding: 1.5rem;
        transition: var(--transition);
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
    }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }

    .stat-card-icon {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        margin-right: 1rem;
        flex-shrink: 0;
    }

        .stat-card-icon.revenue {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .stat-card-icon.orders {
            background-color: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }

        .stat-card-icon.customers {
            background-color: rgba(247, 37, 133, 0.1);
            color: var(--secondary);
        }

        .stat-card-icon.inventory {
            background-color: rgba(248, 150, 30, 0.1);
            color: var(--warning);
        }

    .stat-card-content {
        flex: 1;
    }

    .stat-card-title {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--gray-600);
        margin-bottom: 0.5rem;
        text-transform: uppercase;
    }

    .stat-card-value {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--gray-900);
        margin-bottom: 0.25rem;
    }

    .stat-card-trend {
        display: flex;
        align-items: center;
        font-size: 0.875rem;
    }

    .trend-up {
        color: #4cc9f0;
    }

    .trend-down {
        color: #f94144;
    }

    /* Dashboard Sections */
    .dashboard-section {
        background-color: #fff;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        margin-bottom: 1.5rem;
        overflow: hidden;
    }

    .dashboard-section-header {
        padding: 1.25rem 1.5rem;
        border-bottom: 1px solid var(--gray-200);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .dashboard-section-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--gray-800);
        margin: 0;
    }

    .dashboard-section-content {
        padding: 1.5rem;
    }

    /* Charts */
    .chart-container {
        width: 100%;
        height: 350px;
    }

    /* Tables */
    .dashboard-table {
        width: 100%;
    }

        .dashboard-table th {
            font-weight: 600;
            color: var(--gray-700);
        }

        .dashboard-table .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

    .status-badge.in-stock {
        background-color: rgba(76, 201, 240, 0.1);
        color: var(--success);
        border: 1px solid rgba(76, 201, 240, 0.2);
    }

    .status-badge.low-stock {
        background-color: rgba(248, 150, 30, 0.1);
        color: var(--warning);
        border: 1px solid rgba(248, 150, 30, 0.2);
    }

    .status-badge.out-of-stock {
        background-color: rgba(249, 65, 68, 0.1);
        color: var(--danger);
        border: 1px solid rgba(249, 65, 68, 0.2);
    }

    .status-badge.active {
        background-color: rgba(76, 201, 240, 0.1);
        color: var(--success);
        border: 1px solid rgba(76, 201, 240, 0.2);
    }

    .status-badge.inactive {
        background-color: rgba(173, 181, 189, 0.1);
        color: var(--gray-600);
        border: 1px solid rgba(173, 181, 189, 0.2);
    }

    /* Progress Bars */
    .progress {
        height: 8px;
        margin-bottom: 0.5rem;
    }

    .progress-bar {
        border-radius: 4px;
    }

    /* Tabs */
    .dashboard-tabs {
        border-bottom: 1px solid var(--gray-200);
        margin-bottom: 1.5rem;
    }

        .dashboard-tabs .nav-link {
            border: none;
            color: var(--gray-600);
            padding: 0.75rem 1rem;
            font-weight: 500;
            position: relative;
        }

            .dashboard-tabs .nav-link:hover {
                color: var(--primary);
            }

            .dashboard-tabs .nav-link.active {
                color: var(--primary);
                background-color: transparent;
            }

                .dashboard-tabs .nav-link.active::after {
                    content: '';
                    position: absolute;
                    bottom: -1px;
                    left: 0;
                    right: 0;
                    height: 2px;
                    background-color: var(--primary);
                }

    /* Inventory Status */
    .inventory-status {
        display: flex;
        align-items: center;
        margin-bottom: 0.5rem;
    }

    .inventory-status-label {
        flex: 1;
        font-size: 0.875rem;
        color: var(--gray-700);
    }

    .inventory-status-value {
        font-weight: 600;
        color: var(--gray-800);
        margin-left: 1rem;
    }

    .inventory-status-bar {
        flex: 2;
        margin: 0 1rem;
    }

    /* Staff Cards */
    .staff-cards {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1.5rem;
    }

    .staff-card {
        background-color: #fff;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        padding: 1.5rem;
        text-align: center;
        transition: var(--transition);
    }

        .staff-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }

    .staff-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        margin: 0 auto 1rem;
        overflow: hidden;
        background-color: var(--gray-200);
    }

        .staff-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

    .staff-name {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--gray-800);
        margin-bottom: 0.25rem;
    }

    .staff-position {
        font-size: 0.875rem;
        color: var(--gray-600);
        margin-bottom: 1rem;
    }

    .staff-stats {
        display: flex;
        justify-content: space-around;
        margin-bottom: 1rem;
    }

    .staff-stat {
        text-align: center;
    }

    .staff-stat-value {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--primary);
    }

    .staff-stat-label {
        font-size: 0.75rem;
        color: var(--gray-600);
    }

    /* Supplier Cards */
    .supplier-cards {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
    }

    .supplier-card {
        background-color: #fff;
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        padding: 1.5rem;
        transition: var(--transition);
    }

        .supplier-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }

    .supplier-header {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
    }

    .supplier-logo {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: var(--gray-200);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        font-size: 1.5rem;
        color: var(--primary);
    }

    .supplier-info {
        flex: 1;
    }

    .supplier-name {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--gray-800);
        margin-bottom: 0.25rem;
    }

    .supplier-category {
        font-size: 0.875rem;
        color: var(--gray-600);
    }

    .supplier-contact {
        margin-bottom: 1rem;
    }

    .supplier-contact-item {
        display: flex;
        align-items: center;
        margin-bottom: 0.5rem;
        font-size: 0.875rem;
    }

        .supplier-contact-item i {
            width: 20px;
            margin-right: 0.5rem;
            color: var(--gray-600);
        }

    .supplier-status {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    /* Popular Dishes */
    .popular-dish {
        display: flex;
        align-items: center;
        margin-bottom: 1.25rem;
    }

        .popular-dish:last-child {
            margin-bottom: 0;
        }

    .popular-dish-image {
        width: 60px;
        height: 60px;
        border-radius: 8px;
        overflow: hidden;
        margin-right: 1rem;
        flex-shrink: 0;
    }

        .popular-dish-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

    .popular-dish-info {
        flex: 1;
    }

    .popular-dish-name {
        font-size: 1rem;
        font-weight: 600;
        color: var(--gray-800);
        margin-bottom: 0.25rem;
    }

    .popular-dish-category {
        font-size: 0.875rem;
        color: var(--gray-600);
        margin-bottom: 0.5rem;
    }

    .popular-dish-stats {
        display: flex;
        align-items: center;
    }

    .popular-dish-price {
        font-weight: 600;
        color: var(--primary);
        margin-right: 1rem;
    }

    .popular-dish-sales {
        font-size: 0.875rem;
        color: var(--gray-600);
    }

    /* Inventory Movement */
    .inventory-movement {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
    }

        .inventory-movement:last-child {
            margin-bottom: 0;
        }

    .inventory-movement-icon {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        flex-shrink: 0;
    }

        .inventory-movement-icon.in {
            background-color: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }

        .inventory-movement-icon.out {
            background-color: rgba(249, 65, 68, 0.1);
            color: var(--danger);
        }

    .bg-import {
        background-color: rgba(76, 201, 240, 0.1) !important;
    }

    .bg-export {
        background-color: rgba(249, 65, 68, 0.1) !important;
    }

    .bg-adjust {
        background-color: #fff8e1 !important; /* vàng nhạt */
    }

    .inventory-movement-info {
        flex: 1;
    }

    .inventory-movement-title {
        font-size: 1rem;
        font-weight: 500;
        color: var(--gray-800);
        margin-bottom: 0.25rem;
    }

    .inventory-movement-details {
        font-size: 0.875rem;
        color: var(--gray-600);
    }

    .inventory-movement-quantity {
        font-weight: 600;
        margin-left: 1rem;
    }

        .inventory-movement-quantity.in {
            color: var(--success);
        }

        .inventory-movement-quantity.out {
            color: var(--danger);
        }

    /* Responsive */
    @@media (max-width: 992px) {
        .stats-cards

    {
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    }

    .staff-cards, .supplier-cards {
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    }

    }

    @@media (max-width: 768px) {
        .dashboard-container

    {
        padding: 1rem;
    }

    .stats-cards {
        grid-template-columns: repeat(auto-fill, minmax(100%, 1fr));
    }

    .chart-container {
        height: 300px;
    }

    }

    @@media (max-width: 576px) {
        .dashboard-section-header

    {
        flex-direction: column;
        align-items: flex-start;
    }

    .dashboard-section-title {
        margin-bottom: 0.5rem;
    }

    .chart-container {
        height: 250px;
    }

    }

    /* Animations */
    @@keyframes fadeIn {
        from

    {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }

    }

    .fade-in {
        animation: fadeIn 0.3s ease forwards;
    }

    .fade-in-delay-1 {
        animation: fadeIn 0.3s ease 0.1s forwards;
        opacity: 0;
    }

    .fade-in-delay-2 {
        animation: fadeIn 0.3s ease 0.2s forwards;
        opacity: 0;
    }

    .fade-in-delay-3 {
        animation: fadeIn 0.3s ease 0.3s forwards;
        opacity: 0;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    ::-webkit-scrollbar-track {
        background: var(--gray-100);
    }

    ::-webkit-scrollbar-thumb {
        background: var(--gray-400);
        border-radius: 4px;
    }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-500);
        }

    .chart-loading {
        text-align: center;
        padding: 20px;
        display: none;
    }

    .chart-error {
        background-color: #fee2e2;
        color: #ef4444;
        padding: 10px;
        border-radius: 8px;
        margin-bottom: 10px;
        display: none;
    }

    .chart-info {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 10px;
        font-size: 14px;
        color: #7f8c8d;
    }

    .chart-info-value {
        font-weight: 600;
        color: #2c3e50;
        margin-left: 5px;
    }

    .chart-details {
        margin-top: 20px;
    }

    .color-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 8px;
    }

    .table-sm {
        font-size: 14px;
    }

    .date-range {
        font-size: 14px;
        color: #7f8c8d;
        margin-bottom: 10px;
    }
</style>
<div id="kt_app_content" class="app-content  flex-column-fluid ">
    <!--begin::Content container-->
    <div id="kt_app_content_container" class="app-container">
        <!--begin::Row-->
        <div class="dashboard-container">
          
            <!-- Stats Cards -->
            <div class="stats-cards" id="statsContainer">
                <div class="stat-card fade-in">
                    <div class="stat-card-icon revenue">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="stat-card-content">
                        <div class="stat-card-title">Doanh thu hôm nay</div>
                        <div class="stat-card-value">12,580,000 ₫</div>
                        <div class="stat-card-trend">
                            <i class="fas fa-arrow-up me-1 trend-up"></i>
                            <span>15% so với hôm qua</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card fade-in-delay-1">
                    <div class="stat-card-icon orders">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <div class="stat-card-content">
                        <div class="stat-card-title">Đơn hàng hôm nay</div>
                        <div class="stat-card-value">85</div>
                        <div class="stat-card-trend">
                            <i class="fas fa-arrow-up me-1 trend-up"></i>
                            <span>8% so với hôm qua</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card fade-in-delay-2">
                    <div class="stat-card-icon customers">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-card-content">
                        <div class="stat-card-title">Nhân viên</div>
                        <div class="stat-card-value">210</div>
                        <div class="stat-card-trend">
                            <i class="fas fa-arrow-up me-1 trend-up"></i>
                            <span>12% so với hôm qua</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card fade-in-delay-3">
                    <div class="stat-card-icon inventory">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <div class="stat-card-content">
                        <div class="stat-card-title">Tồn kho</div>
                        <div class="stat-card-value">45</div>
                        <div class="stat-card-trend">
                            <i class="fas fa-arrow-down me-1 trend-down"></i>
                            <span>3 mặt hàng sắp hết</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card fade-in-delay-3">
                    <div class="stat-card-icon bg-success">
                        <i class="bi bi-cup-hot-fill"></i>
                    </div>
                    <div class="stat-card-content">
                        <div class="stat-card-title">Đồ uống bán ra</div>
                        <div class="stat-card-value">45</div>
                        <div class="stat-card-trend">
                            <i class="fas fa-arrow-down me-1 trend-down"></i>
                            <span>12% so với hôm qua</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Revenue & Orders Charts -->
            <div class="row">
                <div class="col-lg-8 mb-4">
                    <div class="dashboard-section">
                        <div class="dashboard-section-header">
                            <h2 class="dashboard-section-title">Doanh thu & Đơn hàng</h2>
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-sm btn-outline-primary active" id="revenueWeekBtn">Tuần</button>
                                <button type="button" class="btn btn-sm btn-outline-primary" id="revenueMonthBtn">Tháng</button>
                                <button type="button" class="btn btn-sm btn-outline-primary" id="revenueYearBtn">Năm</button>
                            </div>
                        </div>
                        <div class="dashboard-section-content">
                            <div id="revenueChartError" class="chart-error">
                                <i class="fas fa-exclamation-circle me-2"></i> Có lỗi xảy ra khi tải dữ liệu biểu đồ. Vui lòng thử lại sau.
                            </div>

                            <div id="revenueChartLoading" class="chart-loading">
                                <i class="fas fa-spinner fa-spin me-2"></i> Đang tải dữ liệu biểu đồ...
                            </div>

                            <div id="revenueChart"></div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4 mb-4">
                    <div class="dashboard-section">
                        <div class="dashboard-section-header">
                            <h2 class="dashboard-section-title">Phân loại đơn hàng</h2>
                        </div>
                        <div class="dashboard-section-content">
                            <div class="chart-container" >
                                <div class="chart-card">
                                    <div class="chart-header d-none">
                                        <div class="chart-title">Tỉ lệ món theo nhóm món</div>
                                        <div class="chart-actions">
                                            <button id="ingredientCategory7DaysBtn" class="chart-btn">7 ngày</button>
                                            <button id="ingredientCategory30DaysBtn" class="chart-btn active">30 ngày</button>
                                            <button id="ingredientCategoryAllTimeBtn" class="chart-btn">Tất cả</button>
                                        </div>
                                    </div>

                                    <div id="ingredientCategoryChartError" class="chart-error">
                                        <i class="fas fa-exclamation-circle me-2"></i> Có lỗi xảy ra khi tải dữ liệu biểu đồ. Vui lòng thử lại sau.
                                    </div>

                                    <div id="ingredientCategoryChartLoading" class="chart-loading">
                                        <i class="fas fa-spinner fa-spin me-2"></i> Đang tải dữ liệu biểu đồ...
                                    </div>

                                    <div id="ingredientCategoryChart"></div>

                                    <div class="chart-info">
                                        <span>Tổng số món đã bán:</span>
                                        <span id="totalIngredientsSold" class="chart-info-value">0</span>
                                    </div>

                                    <!-- Bảng chi tiết -->
                                    <div class="chart-details">
                                        <h6>Chi tiết theo nhóm món</h6>
                                        <div class="table-responsive">
                                            <table class="table table-sm">
                                                <thead>
                                                    <tr>
                                                        <th>Nhóm món</th>
                                                        <th class="text-end">Số lượng</th>
                                                        <th class="text-end">Tỉ lệ</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="ingredientCategoryTableBody">
                                                    <!-- Dữ liệu sẽ được thêm bằng JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Popular Dishes & Inventory Movement -->
            <div class="row">
                <div class="col-lg-6 mb-4">
                    <div class="dashboard-section">
                        <div class="dashboard-section-header">
                            <h2 class="dashboard-section-title">Món ăn bán chạy</h2>
                            <button class="btn btn-sm btn-outline-primary" id="viewAllDishesBtn">Xem tất cả</button>
                        </div>
                        <div class="dashboard-section-content" id="popularDish">
                            <div class="popular-dish">
                                <div class="popular-dish-image">
                                    <img src="https://via.placeholder.com/60x60" alt="Bún bò Huế">
                                </div>
                                <div class="popular-dish-info">
                                    <div class="popular-dish-name">Bún bò Huế</div>
                                    <div class="popular-dish-category">Món chính</div>
                                    <div class="popular-dish-stats">
                                        <div class="popular-dish-price">75,000 ₫</div>
                                        <div class="popular-dish-sales">Đã bán: 128 trong tháng</div>
                                    </div>
                                </div>
                            </div>

                            <div class="popular-dish">
                                <div class="popular-dish-image">
                                    <img src="https://via.placeholder.com/60x60" alt="Cơm tấm sườn bì chả">
                                </div>
                                <div class="popular-dish-info">
                                    <div class="popular-dish-name">Cơm tấm sườn bì chả</div>
                                    <div class="popular-dish-category">Món chính</div>
                                    <div class="popular-dish-stats">
                                        <div class="popular-dish-price">85,000 ₫</div>
                                        <div class="popular-dish-sales">Đã bán: 112 trong tháng</div>
                                    </div>
                                </div>
                            </div>

                            <div class="popular-dish">
                                <div class="popular-dish-image">
                                    <img src="https://via.placeholder.com/60x60" alt="Gỏi cuốn tôm thịt">
                                </div>
                                <div class="popular-dish-info">
                                    <div class="popular-dish-name">Gỏi cuốn tôm thịt</div>
                                    <div class="popular-dish-category">Khai vị</div>
                                    <div class="popular-dish-stats">
                                        <div class="popular-dish-price">65,000 ₫</div>
                                        <div class="popular-dish-sales">Đã bán: 95 trong tháng</div>
                                    </div>
                                </div>
                            </div>

                            <div class="popular-dish">
                                <div class="popular-dish-image">
                                    <img src="https://via.placeholder.com/60x60" alt="Chè thái">
                                </div>
                                <div class="popular-dish-info">
                                    <div class="popular-dish-name">Chè thái</div>
                                    <div class="popular-dish-category">Tráng miệng</div>
                                    <div class="popular-dish-stats">
                                        <div class="popular-dish-price">35,000 ₫</div>
                                        <div class="popular-dish-sales">Đã bán: 87 trong tháng</div>
                                    </div>
                                </div>
                            </div>

                            <div class="popular-dish">
                                <div class="popular-dish-image">
                                    <img src="https://via.placeholder.com/60x60" alt="Trà đào cam sả">
                                </div>
                                <div class="popular-dish-info">
                                    <div class="popular-dish-name">Trà đào cam sả</div>
                                    <div class="popular-dish-category">Đồ uống</div>
                                    <div class="popular-dish-stats">
                                        <div class="popular-dish-price">45,000 ₫</div>
                                        <div class="popular-dish-sales">Đã bán: 76 trong tháng</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 mb-4">
                    <div class="dashboard-section" id="recent-stock-transactions">
                        <div class="dashboard-section-header">
                            <h2 class="dashboard-section-title">Biến động kho gần đây</h2>
                            <button id="view-all-stock-transactions" class="btn btn-sm btn-outline-primary">Xem tất cả</button>
                        </div>
                        <div class="dashboard-section-content" id="recent-transactions-content">
                            <!-- Dữ liệu động sẽ được đổ vào đây -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="stockTransactionModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
                <div class="modal-dialog modal-xl" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Tất cả giao dịch kho</h5>
                            <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                                <span>&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <table id="stockTransactionTable" class="table table-bordered" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>Loại giao dịch</th>
                                        <th>Nguyên liệu</th>
                                        <th>Người tạo</th>
                                        <th>Thời gian</th>
                                        <th>Số lượng</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Inventory Status -->
            <div class="row d-none">
                <div class="col-12 mb-4">
                    <div class="dashboard-section">
                        <div class="dashboard-section-header">
                            <h2 class="dashboard-section-title">Tình trạng kho hàng</h2>
                            <div>
                                <button class="btn btn-sm btn-outline-primary me-2">Nhập kho</button>
                                <button class="btn btn-sm btn-outline-primary">Xuất kho</button>
                            </div>
                        </div>
                        <div class="dashboard-section-content">
                            <ul class="nav nav-tabs dashboard-tabs" id="inventoryTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="inventory-tab" data-bs-toggle="tab" data-bs-target="#inventory" type="button" role="tab" aria-controls="inventory" aria-selected="true">
                                        Tồn kho
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="ingredients-tab" data-bs-toggle="tab" data-bs-target="#ingredients" type="button" role="tab" aria-controls="ingredients" aria-selected="false">
                                        Nguyên liệu
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="incoming-tab" data-bs-toggle="tab" data-bs-target="#incoming" type="button" role="tab" aria-controls="incoming" aria-selected="false">
                                        Nhập kho
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="outgoing-tab" data-bs-toggle="tab" data-bs-target="#outgoing" type="button" role="tab" aria-controls="outgoing" aria-selected="false">
                                        Xuất kho
                                    </button>
                                </li>
                            </ul>

                            <div class="tab-content" id="inventoryTabsContent">
                                <div class="tab-pane fade show active" id="inventory" role="tabpanel" aria-labelledby="inventory-tab">
                                    <div class="table-responsive">
                                        <table class="table dashboard-table" id="inventoryTable">
                                            <thead>
                                                <tr>
                                                    <th>Mã SP</th>
                                                    <th>Tên sản phẩm</th>
                                                    <th>Danh mục</th>
                                                    <th>Số lượng</th>
                                                    <th>Đơn vị</th>
                                                    <th>Trạng thái</th>
                                                    <th>Cập nhật cuối</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>SP001</td>
                                                    <td>Thịt bò</td>
                                                    <td>Thịt</td>
                                                    <td>45</td>
                                                    <td>kg</td>
                                                    <td><span class="status-badge in-stock">Còn hàng</span></td>
                                                    <td>15/05/2023 08:30</td>
                                                </tr>
                                                <tr>
                                                    <td>SP002</td>
                                                    <td>Thịt gà</td>
                                                    <td>Thịt</td>
                                                    <td>28</td>
                                                    <td>kg</td>
                                                    <td><span class="status-badge in-stock">Còn hàng</span></td>
                                                    <td>15/05/2023 11:30</td>
                                                </tr>
                                                <tr>
                                                    <td>SP003</td>
                                                    <td>Rau xanh</td>
                                                    <td>Rau củ</td>
                                                    <td>12</td>
                                                    <td>kg</td>
                                                    <td><span class="status-badge low-stock">Sắp hết</span></td>
                                                    <td>15/05/2023 09:15</td>
                                                </tr>
                                                <tr>
                                                    <td>SP004</td>
                                                    <td>Cà chua</td>
                                                    <td>Rau củ</td>
                                                    <td>18</td>
                                                    <td>kg</td>
                                                    <td><span class="status-badge in-stock">Còn hàng</span></td>
                                                    <td>14/05/2023 16:45</td>
                                                </tr>
                                                <tr>
                                                    <td>SP005</td>
                                                    <td>Tôm sú</td>
                                                    <td>Hải sản</td>
                                                    <td>8</td>
                                                    <td>kg</td>
                                                    <td><span class="status-badge low-stock">Sắp hết</span></td>
                                                    <td>14/05/2023 14:30</td>
                                                </tr>
                                                <tr>
                                                    <td>SP006</td>
                                                    <td>Mực tươi</td>
                                                    <td>Hải sản</td>
                                                    <td>0</td>
                                                    <td>kg</td>
                                                    <td><span class="status-badge out-of-stock">Hết hàng</span></td>
                                                    <td>13/05/2023 10:15</td>
                                                </tr>
                                                <tr>
                                                    <td>SP007</td>
                                                    <td>Bột mì</td>
                                                    <td>Gia vị</td>
                                                    <td>25</td>
                                                    <td>kg</td>
                                                    <td><span class="status-badge in-stock">Còn hàng</span></td>
                                                    <td>12/05/2023 09:30</td>
                                                </tr>
                                                <tr>
                                                    <td>SP008</td>
                                                    <td>Dầu ăn</td>
                                                    <td>Gia vị</td>
                                                    <td>15</td>
                                                    <td>lít</td>
                                                    <td><span class="status-badge in-stock">Còn hàng</span></td>
                                                    <td>11/05/2023 14:45</td>
                                                </tr>
                                                <tr>
                                                    <td>SP009</td>
                                                    <td>Nước mắm</td>
                                                    <td>Gia vị</td>
                                                    <td>8</td>
                                                    <td>lít</td>
                                                    <td><span class="status-badge low-stock">Sắp hết</span></td>
                                                    <td>10/05/2023 11:30</td>
                                                </tr>
                                                <tr>
                                                    <td>SP010</td>
                                                    <td>Trứng gà</td>
                                                    <td>Khác</td>
                                                    <td>120</td>
                                                    <td>quả</td>
                                                    <td><span class="status-badge in-stock">Còn hàng</span></td>
                                                    <td>09/05/2023 15:15</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="tab-pane fade" id="ingredients" role="tabpanel" aria-labelledby="ingredients-tab">
                                    <div class="row mb-4">
                                        <div class="col-md-6 col-lg-3 mb-3">
                                            <div class="card">
                                                <div class="card-body">
                                                    <h5 class="card-title">Thịt</h5>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Thịt bò</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-success" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">45kg</div>
                                                    </div>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Thịt gà</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-success" role="progressbar" style="width: 60%" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">28kg</div>
                                                    </div>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Thịt heo</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-warning" role="progressbar" style="width: 35%" aria-valuenow="35" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">15kg</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-6 col-lg-3 mb-3">
                                            <div class="card">
                                                <div class="card-body">
                                                    <h5 class="card-title">Rau củ</h5>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Rau xanh</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-warning" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">12kg</div>
                                                    </div>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Cà chua</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-success" role="progressbar" style="width: 45%" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">18kg</div>
                                                    </div>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Khoai tây</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-success" role="progressbar" style="width: 65%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">30kg</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-6 col-lg-3 mb-3">
                                            <div class="card">
                                                <div class="card-body">
                                                    <h5 class="card-title">Hải sản</h5>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Tôm sú</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-warning" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">8kg</div>
                                                    </div>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Mực tươi</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-danger" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">0kg</div>
                                                    </div>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Cá hồi</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-success" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">20kg</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-6 col-lg-3 mb-3">
                                            <div class="card">
                                                <div class="card-body">
                                                    <h5 class="card-title">Gia vị</h5>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Bột mì</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-success" role="progressbar" style="width: 55%" aria-valuenow="55" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">25kg</div>
                                                    </div>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Dầu ăn</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-success" role="progressbar" style="width: 40%" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">15 lít</div>
                                                    </div>
                                                    <div class="inventory-status">
                                                        <div class="inventory-status-label">Nước mắm</div>
                                                        <div class="inventory-status-bar">
                                                            <div class="progress">
                                                                <div class="progress-bar bg-warning" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
                                                            </div>
                                                        </div>
                                                        <div class="inventory-status-value">8 lít</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="chart-container" id="ingredientCategoryChart"></div>
                                </div>

                                <div class="tab-pane fade" id="incoming" role="tabpanel" aria-labelledby="incoming-tab">
                                    <div class="table-responsive">
                                        <table class="table dashboard-table" id="incomingTable">
                                            <thead>
                                                <tr>
                                                    <th>Mã phiếu</th>
                                                    <th>Ngày nhập</th>
                                                    <th>Nhà cung cấp</th>
                                                    <th>Sản phẩm</th>
                                                    <th>Số lượng</th>
                                                    <th>Đơn vị</th>
                                                    <th>Giá nhập</th>
                                                    <th>Người nhập</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>NK001</td>
                                                    <td>15/05/2023 08:30</td>
                                                    <td>Thịt sạch ABC</td>
                                                    <td>Thịt bò</td>
                                                    <td>25</td>
                                                    <td>kg</td>
                                                    <td>250,000 ₫</td>
                                                    <td>Nguyễn Văn A</td>
                                                </tr>
                                                <tr>
                                                    <td>NK002</td>
                                                    <td>15/05/2023 10:45</td>
                                                    <td>Gia vị Việt</td>
                                                    <td>Gia vị</td>
                                                    <td>15</td>
                                                    <td>gói</td>
                                                    <td>450,000 ₫</td>
                                                    <td>Trần Thị B</td>
                                                </tr>
                                                <tr>
                                                    <td>NK003</td>
                                                    <td>15/05/2023 13:15</td>
                                                    <td>Hải sản tươi XYZ</td>
                                                    <td>Hải sản</td>
                                                    <td>18</td>
                                                    <td>kg</td>
                                                    <td>1,800,000 ₫</td>
                                                    <td>Lê Văn C</td>
                                                </tr>
                                                <tr>
                                                    <td>NK004</td>
                                                    <td>14/05/2023 09:30</td>
                                                    <td>Rau sạch 123</td>
                                                    <td>Rau xanh</td>
                                                    <td>20</td>
                                                    <td>kg</td>
                                                    <td>400,000 ₫</td>
                                                    <td>Nguyễn Văn A</td>
                                                </tr>
                                                <tr>
                                                    <td>NK005</td>
                                                    <td>14/05/2023 11:15</td>
                                                    <td>Thịt sạch ABC</td>
                                                    <td>Thịt gà</td>
                                                    <td>30</td>
                                                    <td>kg</td>
                                                    <td>750,000 ₫</td>
                                                    <td>Trần Thị B</td>
                                                </tr>
                                                <tr>
                                                    <td>NK006</td>
                                                    <td>13/05/2023 14:30</td>
                                                    <td>Gia vị Việt</td>
                                                    <td>Dầu ăn</td>
                                                    <td>20</td>
                                                    <td>lít</td>
                                                    <td>600,000 ₫</td>
                                                    <td>Lê Văn C</td>
                                                </tr>
                                                <tr>
                                                    <td>NK007</td>
                                                    <td>12/05/2023 10:45</td>
                                                    <td>Trứng sạch</td>
                                                    <td>Trứng gà</td>
                                                    <td>150</td>
                                                    <td>quả</td>
                                                    <td>450,000 ₫</td>
                                                    <td>Nguyễn Văn A</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="tab-pane fade" id="outgoing" role="tabpanel" aria-labelledby="outgoing-tab">
                                    <div class="table-responsive">
                                        <table class="table dashboard-table" id="outgoingTable">
                                            <thead>
                                                <tr>
                                                    <th>Mã phiếu</th>
                                                    <th>Ngày xuất</th>
                                                    <th>Bộ phận</th>
                                                    <th>Sản phẩm</th>
                                                    <th>Số lượng</th>
                                                    <th>Đơn vị</th>
                                                    <th>Người xuất</th>
                                                    <th>Ghi chú</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>XK001</td>
                                                    <td>15/05/2023 09:15</td>
                                                    <td>Bếp chính</td>
                                                    <td>Rau xanh</td>
                                                    <td>8</td>
                                                    <td>kg</td>
                                                    <td>Nguyễn Văn A</td>
                                                    <td>Phục vụ bữa trưa</td>
                                                </tr>
                                                <tr>
                                                    <td>XK002</td>
                                                    <td>15/05/2023 11:30</td>
                                                    <td>Bếp phụ</td>
                                                    <td>Thịt gà</td>
                                                    <td>12</td>
                                                    <td>kg</td>
                                                    <td>Trần Thị B</td>
                                                    <td>Chuẩn bị món mới</td>
                                                </tr>
                                                <tr>
                                                    <td>XK003</td>
                                                    <td>15/05/2023 14:45</td>
                                                    <td>Bếp chính</td>
                                                    <td>Thịt bò</td>
                                                    <td>10</td>
                                                    <td>kg</td>
                                                    <td>Lê Văn C</td>
                                                    <td>Phục vụ bữa tối</td>
                                                </tr>
                                                <tr>
                                                    <td>XK004</td>
                                                    <td>14/05/2023 10:30</td>
                                                    <td>Bếp phụ</td>
                                                    <td>Cà chua</td>
                                                    <td>5</td>
                                                    <td>kg</td>
                                                    <td>Nguyễn Văn A</td>
                                                    <td>Làm nước sốt</td>
                                                </tr>
                                                <tr>
                                                    <td>XK005</td>
                                                    <td>14/05/2023 12:15</td>
                                                    <td>Bếp chính</td>
                                                    <td>Tôm sú</td>
                                                    <td>7</td>
                                                    <td>kg</td>
                                                    <td>Trần Thị B</td>
                                                    <td>Món đặc biệt</td>
                                                </tr>
                                                <tr>
                                                    <td>XK006</td>
                                                    <td>13/05/2023 15:30</td>
                                                    <td>Bếp phụ</td>
                                                    <td>Bột mì</td>
                                                    <td>5</td>
                                                    <td>kg</td>
                                                    <td>Lê Văn C</td>
                                                    <td>Làm bánh</td>
                                                </tr>
                                                <tr>
                                                    <td>XK007</td>
                                                    <td>13/05/2023 09:45</td>
                                                    <td>Bếp chính</td>
                                                    <td>Mực tươi</td>
                                                    <td>6</td>
                                                    <td>kg</td>
                                                    <td>Nguyễn Văn A</td>
                                                    <td>Món đặc biệt</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                $(document).ready(() => {
                  // Gọi API để lấy dữ liệu thống kê
                  fetchDashboardStatistics()

                  // Thiết lập cập nhật tự động mỗi 5 phút
                  setInterval(fetchDashboardStatistics, 5 * 60 * 1000)
                })

                function fetchDashboardStatistics() {
                  $.ajax({
                    url: systemURL + "Statistics/api/dashboard",
                    type: "GET",
                    dataType: "json",
                    success: (response) => {
                      if (response.status == 200) {
                        renderStatistics(response.data)
                      } else {
                        showError(response.message)
                      }
                    },
                    error: (xhr, status, error) => {
                      showError("Không thể kết nối đến máy chủ. Vui lòng thử lại sau.")
                      console.error("Error fetching statistics:", error)
                    },
                  })
                }

                function renderStatistics(statistics) {
                  // Xóa nội dung hiện tại
                  const container = $("#statsContainer")
                  container.empty()

                  // Kiểm tra nếu không có dữ liệu
                  if (!statistics || statistics.length === 0) {
                    container.html('<div class="alert alert-info">Không có dữ liệu thống kê.</div>')
                    return
                  }

                  // Render từng thẻ thống kê với hiệu ứng delay
                  statistics.forEach((stat, index) => {
                    const delayClass = index > 0 ? `fade-in-delay-${Math.min(index, 3)}` : "fade-in"

                    const trendIcon = stat.isPositiveTrend
                      ? '<i class="fas fa-arrow-up me-1 trend-up"></i>'
                      : '<i class="fas fa-arrow-down me-1 trend-down"></i>'

                    const statCard = `
                            <div class="stat-card ${delayClass}">
                                <div class="stat-card-icon ${stat.cardClass}">
                                    <i class="${stat.iconClass}"></i>
                                </div>
                                <div class="stat-card-content">
                                    <div class="stat-card-title">${stat.title}</div>
                                    <div class="stat-card-value">${stat.value}</div>
                                    <div class="stat-card-trend">
                                        ${trendIcon}
                                        <span>${stat.trendText}</span>
                                    </div>
                                </div>
                            </div>
                        `

                    container.append(statCard)
                  })
                }

                function showError(message) {
                  const container = $("#statsContainer")
                  container.html(`
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-circle me-2"></i>
                            ${message}
                        </div>
                        <button class="btn btn-primary mt-3" onclick="fetchDashboardStatistics()">
                            <i class="fas fa-sync-alt me-2"></i> Thử lại
                        </button>
                    `)
                }

            </script>

            <!-- Staff & Suppliers -->
            <div class="row">
                <div class="col-lg-6 mb-4">
                    <div class="dashboard-section">
                        <div class="dashboard-section-header">
                            <h2 class="dashboard-section-title">Nhân viên</h2>
                        </div>

                        <!-- DataTable ẩn để lấy dữ liệu -->
                        <table id="accountDataTable" class="d-none">
                            <thead>
                                <tr>
                                    <th>Id</th>
                                    <th>FullName</th>
                                    <th>Username</th>
                                    <th>Photo</th>
                                    <th>RoleName</th>
                                    <th>TotalInvoice</th>
                                    <th>TotalInvoiceValue</th>
                                    <th>TotalPurchaseOrder</th>
                                    <th>TotalPurchaseOrderValue</th>
                                    <th>TotalDishOrder</th>
                                    <th>TotalTableBooking</th>
                                </tr>
                            </thead>
                        </table>

                        <!-- Vùng hiển thị card -->
                        <div class="dashboard-section-content">
                            <div id="staffCardsContainer" class="staff-cards"></div>

                            <!-- Phân trang -->
                            <div class="d-flex justify-content-end mt-3">
                                <ul id="staffPagination" class="pagination pagination-sm"></ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 mb-4">
                    <div class="dashboard-section">
                        <div class="dashboard-section-header">
                            <h2 class="dashboard-section-title">Nhà cung cấp</h2>
                            
                        </div>
                        <!-- DataTable ẩn để lấy dữ liệu -->
                        <table id="supplierDataTable" class="d-none">
                            <thead>
                                <tr>
                                    <th>Id</th>
                                    <th>SupplierCode</th>
                                    <th>SupplierName</th>
                                    <th>ContactInfo</th>
                                    <th>Address</th>
                                    <th>CreatedTime</th>
                                    <th>TotalDebt</th>
                                </tr>
                            </thead>
                        </table>

                        <!-- Vùng hiển thị card -->
                        <div class="dashboard-section-content">
                            <div id="supplierCardsContainer" class="supplier-cards"></div>

                            <!-- Phân trang -->
                            <div class="d-flex justify-content-end mt-3">
                                <ul id="supplierPagination" class="pagination pagination-sm"></ul>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--end::Content container-->
    <!-- ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.min.js"></script>

    <script>
        const staffPerPage = 4; // Hiển thị 4 nhân viên mỗi trang
        let staffDataCache = [];

        function initAccountDataTable() {
            $('#accountDataTable').DataTable({
                processing: true,
                serverSide: true,
                searching: false,
                paging: true,
                info: false,      // Tắt thông báo "Showing 1 to 6 of 6 records"
        lengthChange: false, // Tắt dropdown chọn số bản ghi mỗi trang
        pagingType: "simple_numbers", // Kiểu phân trang đơn giản
        dom: "<'row'<'col-sm-12'tr>>",
                pageLength: 1000, // Lấy nhiều để phân trang client
                ajax: {
                    url: systemURL + "account/api/list-server-side-summary",
                    type: "POST",
                    contentType: "application/json",
                    dataType: "json",
                    data: function (d) {
                        d.searchAll = "";
                        return JSON.stringify(d);
                    }
                },
                columns: [
                    { data: "id" },
                    { data: "fullName" },
                    { data: "username" },
                    { data: "photo" },
                    { data: "roleName" },
                    { data: "totalInvoice" },
                    { data: "totalInvoiceValue" },
                    { data: "totalPurchaseOrder" },
                    { data: "totalPurchaseOrderValue" },
                    { data: "totalDishOrder" },
                    { data: "totalTableBooking" }
                ],
                drawCallback: function (settings) {
                    const data = settings.json?.data || [];
                    staffDataCache = data;
                    renderStaffCards(1);
                }
            });
        }

        function renderStaffCards(page) {
            const startIndex = (page - 1) * staffPerPage;
            const endIndex = startIndex + staffPerPage;
            const currentStaff = staffDataCache.slice(startIndex, endIndex);
            const $container = $('#staffCardsContainer');
            $container.empty();

            currentStaff.forEach(staff => {
                const defaultPhoto = "/images/default/authdefaultimage.png";
                const imgSrc = staff.photo ? `${systemURL}${staff.photo}` : defaultPhoto;
                const cardHtml = `
                <div class="staff-card">
                    <div class="staff-avatar">
                        <img src="${imgSrc}" alt="${staff.fullName}">
                    </div>
                    <div class="staff-name">${staff.fullName}</div>
                    <div class="staff-position">${staff.roleName}</div>
                    <div class="staff-stats">
                        <div class="staff-stat">
                            <div class="staff-stat-value">${staff.totalInvoice}</div>
                            <div class="staff-stat-label">Hóa đơn</div>
                        </div>
                        <div class="staff-stat">
                            <div class="staff-stat-value">${staff.totalDishOrder}</div>
                            <div class="staff-stat-label">Tổng order</div>
                        </div>
                        <div class="staff-stat">
                            <div class="staff-stat-value">${staff.totalPurchaseOrder}</div>
                            <div class="staff-stat-label">Nhập hàng</div>
                        </div>
                    </div>
                    <div class="staff-stats">
                        <div class="staff-stat">
                            <div class="staff-stat-value">${formatCurrencyDB(staff.totalInvoiceValue)}</div>
                            <div class="staff-stat-label">Doanh thu</div>
                        </div>
                        <div class="staff-stat">
                                    <div class="staff-stat-value">${staff.totalTableBooking}</div>
                                    <div class="staff-stat-label">Đặt bàn</div>
                        </div>
                        <div class="staff-stat">
                            <div class="staff-stat-value">${formatCurrencyDB(staff.totalPurchaseOrderValue)}</div>
                            <div class="staff-stat-label">Giá trị nhập</div>
                        </div>
                    </div>
                </div>`;

                $container.append(cardHtml);
            });

            renderStaffPagination(page);
        }

        function renderStaffPagination(currentPage) {
            const totalPages = Math.ceil(staffDataCache.length / staffPerPage);
            const $pagination = $('#staffPagination');
            $pagination.empty();

            // Nút Previous
            $pagination.append(`
                <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="renderStaffCards(${currentPage - 1}); return false;">&laquo;</a>
                </li>`);

            // Các nút số trang
            for (let i = 1; i <= totalPages; i++) {
                $pagination.append(`
                    <li class="page-item ${i === currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="renderStaffCards(${i}); return false;">${i}</a>
                    </li>`);
            }

            // Nút Next
            $pagination.append(`
                <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="renderStaffCards(${currentPage + 1}); return false;">&raquo;</a>
                </li>`);
        }

        $(document).ready(function () {
            initAccountDataTable();
        });
    </script>

    <script>
        const suppliersPerPage = 6;
        let supplierDataCache = [];

        function initSupplierDataTable() {
            $('#supplierDataTable').DataTable({
                processing: true,
                serverSide: true,
                searching: false,
                paging: true,
                info: false,      // Tắt thông báo "Showing 1 to 6 of 6 records"
        lengthChange: false, // Tắt dropdown chọn số bản ghi mỗi trang
        pagingType: "simple_numbers", // Kiểu phân trang đơn giản
        dom: "<'row'<'col-sm-12'tr>>",
                pageLength: 1000, // Lấy nhiều để phân trang client
                ajax: {
                    url: systemURL + "supplier/api/list-server-side",
                    type: "POST",
                    contentType: "application/json",
                    dataType: "json",
                    data: function (d) {
                        d.searchAll = "";
                        return JSON.stringify(d);
                    }
                },
                columns: [
                    { data: "id" },
                    { data: "supplierCode" },
                    { data: "supplierName" },
                    { data: "contactInfo" },
                    { data: "address" },
                    { data: "createdTime" },
                    { data: "totalDebt" }
                ],
                drawCallback: function (settings) {
                    const data = settings.json?.data || [];
                    supplierDataCache = data;
                    renderSupplierCards(1);
                }
            });
        }

        function renderSupplierCards(page) {
            const startIndex = (page - 1) * suppliersPerPage;
            const endIndex = startIndex + suppliersPerPage;
            const currentSuppliers = supplierDataCache.slice(startIndex, endIndex);
            const $container = $('#supplierCardsContainer');
            $container.empty();

            currentSuppliers.forEach(s => {
                const cardHtml = `
                <div class="supplier-card">
                    <div class="supplier-header">
                        <div class="supplier-logo">
                            <i class="fas fa-truck-loading"></i>
                        </div>
                        <div class="supplier-info">
                            <div class="supplier-name fw-bold">${s.supplierName}</div>
                            <div class="supplier-category">${s.supplierCode}</div>
                        </div>
                    </div>
                    <div class="supplier-contact">
                        <div class="supplier-contact-item"><i class="fas fa-phone"></i> <span>${s.contactInfo}</span></div>
                        <div class="supplier-contact-item"><i class="fas fa-map-marker-alt"></i> <span>${s.address}</span></div>
                    </div>
                    <div class="supplier-status d-flex justify-content-between align-items-center mt-2">
                        <span class="text-danger fw-bold">Tổng nợ: ${formatCurrencyDB(s.totalDebt)}</span>
                    </div>
                </div>`;
                 
                $container.append(cardHtml);
            });

            renderPagination(page);
        }

        function renderPagination(currentPage) {
            const totalPages = Math.ceil(supplierDataCache.length / suppliersPerPage);
            const $pagination = $('#supplierPagination');
            $pagination.empty();

            for (let i = 1; i <= totalPages; i++) {
                $pagination.append(`
                    <li class="page-item ${i === currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="renderSupplierCards(${i}); return false;">${i}</a>
                    </li>`);
            }
        }
        $(document).ready(function () {
            initSupplierDataTable();
        });

    </script>

    <script>
        let dishTable;
        // Initialize DataTables
        $(document).ready(function() {
            $('#inventoryTable').DataTable({
                language: {
                    "sUrl": "/js/Vietnamese.json"
                },
                pageLength: 5,
                lengthMenu: [5, 10, 25, 50],
                responsive: true
            });

            $('#incomingTable').DataTable({
                language: {
                    "sUrl": "/js/Vietnamese.json"
                },
                pageLength: 5,
                lengthMenu: [5, 10, 25, 50],
                responsive: true
            });

            $('#outgoingTable').DataTable({
                language: {
                    "sUrl": "/js/Vietnamese.json"
                },
                pageLength: 5,
                lengthMenu: [5, 10, 25, 50],
                responsive: true
            });

                  initRevenueChart()

                // Thiết lập sự kiện cho các nút chuyển đổi thời gian
                setupTimeRangeButtons()

                        initIngredientCategoryChart()

          // Thiết lập sự kiện cho nút lọc
          setupFilterButtons()

                loadPopularDishes();
                loadRecentStockTransactions();

        // Xử lý sự kiện khi click vào nút "Xem tất cả"
        $("#viewAllDishesBtn").on("click", () => {
          openPopularDishesModal()
        })
        });

                function initRevenueChart() {
          // Tạo tùy chọn biểu đồ mặc định
          var revenueOptions = {
            series: [
              {
                name: "Doanh thu",
                type: "column",
                data: [],
              },
              {
                name: "Đơn hàng",
                type: "line",
                data: [],
              },
            ],
            chart: {
              height: 350,
              type: "line",
              toolbar: {
                show: false,
              },
            },
            stroke: {
              width: [0, 3],
              curve: "smooth",
            },
            plotOptions: {
              bar: {
                columnWidth: "60%",
                borderRadius: 5,
              },
            },
            fill: {
              opacity: [0.85, 1],
              gradient: {
                inverseColors: false,
                shade: "light",
                type: "vertical",
                opacityFrom: 0.85,
                opacityTo: 0.55,
                stops: [0, 100, 100, 100],
              },
            },
            markers: {
              size: 4,
              colors: ["#4cc9f0"],
              strokeColors: "#fff",
              strokeWidth: 2,
              hover: {
                size: 7,
              },
            },
            xaxis: {
              categories: [],
            },
            yaxis: [
              {
                title: {
                  text: "Doanh thu (VNĐ)",
                },
                labels: {
                  formatter: (val) => val.toLocaleString("vi-VN") + " ₫",
                },
              },
              {
                opposite: true,
                title: {
                  text: "Đơn hàng",
                },
              },
            ],
            tooltip: {
              shared: true,
              intersect: false,
              y: [
                {
                  formatter: (y) => {
                    if (typeof y !== "undefined") {
                      return y.toLocaleString("vi-VN") + " ₫"
                    }
                    return y
                  },
                },
                {
                  formatter: (y) => {
                    if (typeof y !== "undefined") {
                      return y + " đơn"
                    }
                    return y
                  },
                },
              ],
            },
            colors: ["#4361ee", "#4cc9f0"],
          }

          // Khởi tạo biểu đồ
          window.revenueChart = new ApexCharts(document.querySelector("#revenueChart"), revenueOptions)
          window.revenueChart.render()

          // Tải dữ liệu mặc định (tuần)
          fetchRevenueData("week")
        }

        function setupTimeRangeButtons() {
          // Thiết lập sự kiện cho nút tuần
          $("#revenueWeekBtn").on("click", function () {
            $(this).addClass("active")
            $("#revenueMonthBtn").removeClass("active")
            $("#revenueYearBtn").removeClass("active")
            fetchRevenueData("week")
          })

          // Thiết lập sự kiện cho nút tháng
          $("#revenueMonthBtn").on("click", function () {
            $(this).addClass("active")
            $("#revenueWeekBtn").removeClass("active")
            $("#revenueYearBtn").removeClass("active")
            fetchRevenueData("month")
          })

          // Thiết lập sự kiện cho nút năm
          $("#revenueYearBtn").on("click", function () {
            $(this).addClass("active")
            $("#revenueWeekBtn").removeClass("active")
            $("#revenueMonthBtn").removeClass("active")
            fetchRevenueData("year")
          })
        }

        function fetchRevenueData(period) {
          // Hiển thị trạng thái đang tải
          $("#revenueChartLoading").show()

          // Gọi API để lấy dữ liệu biểu đồ
          $.ajax({
            url: systemURL + `statistics/api/revenue`,
            type: "GET",
            data: {
              period: period,
            },
            success: (response) => {
              if (response.status == 200 && response.data) {
                // Cập nhật biểu đồ với dữ liệu mới
                window.revenueChart.updateOptions({
                  series: [
                    {
                      name: "Doanh thu",
                      type: "column",
                      data: response.data[0].revenue,
                    },
                    {
                      name: "Đơn hàng",
                      type: "line",
                      data: response.data[0].orders,
                    },
                  ],
                  xaxis: {
                    categories: response.data[0].labels,
                  },
                })
              } else {
                console.error("Lỗi khi tải dữ liệu biểu đồ:", response.message)
                showChartError()
              }

              // Ẩn trạng thái đang tải
              $("#revenueChartLoading").hide()
            },
            error: (xhr, status, error) => {
              console.error("Lỗi khi gọi API:", error)
              showChartError()

              // Ẩn trạng thái đang tải
              $("#revenueChartLoading").hide()
            },
          })
        }

        function showChartError() {
          // Hiển thị thông báo lỗi
          $("#revenueChartError").show()

          // Tự động ẩn sau 5 giây
          setTimeout(() => {
            $("#revenueChartError").fadeOut()
          }, 5000)
        }

                function initIngredientCategoryChart() {
          // Tạo tùy chọn biểu đồ mặc định
          var ingredientCategoryOptions = {
            series: [],
            chart: {
              type: "donut",
              height: 350,
            },
            labels: [],
            colors: [],
            legend: {
              position: "bottom",
            },
            plotOptions: {
              pie: {
                donut: {
                  size: "65%",
                  labels: {
                    show: true,
                    total: {
                      show: true,
                      label: "Tổng món",
                      formatter: (w) => w.globals.seriesTotals.reduce((a, b) => a + b, 0),
                    },
                  },
                },
              },
            },
            responsive: [
              {
                breakpoint: 480,
                options: {
                  chart: {
                    height: 300,
                  },
                  legend: {
                    position: "bottom",
                  },
                },
              },
            ],
            tooltip: {
              y: {
                formatter: (val) => val + " món",
              },
            },
            dataLabels: {
              formatter: (val, opts) => {
                return opts.w.config.labels[opts.seriesIndex] + ": " + val.toFixed(1) + "%"
              },
            },
            states: {
              hover: {
                filter: {
                  type: "darken",
                  value: 0.9,
                },
              },
              active: {
                filter: {
                  type: "darken",
                  value: 0.4,
                },
              },
            },
          }

          // Khởi tạo biểu đồ
          window.ingredientCategoryChart = new ApexCharts(
            document.querySelector("#ingredientCategoryChart"),
            ingredientCategoryOptions,
          )
          window.ingredientCategoryChart.render()

          // Tải dữ liệu mặc định (30 ngày gần nhất)
          fetchIngredientCategoryData()
        }

        function setupFilterButtons() {
          // Thiết lập sự kiện cho nút 7 ngày
          $("#ingredientCategory7DaysBtn").on("click", function () {
            $(this).addClass("active")
            $("#ingredientCategory30DaysBtn").removeClass("active")
            $("#ingredientCategoryAllTimeBtn").removeClass("active")

            const endDate = new Date()
            const startDate = new Date()
            startDate.setDate(startDate.getDate() - 7)

            fetchIngredientCategoryData(startDate, endDate)
          })

          // Thiết lập sự kiện cho nút 30 ngày
          $("#ingredientCategory30DaysBtn").on("click", function () {
            $(this).addClass("active")
            $("#ingredientCategory7DaysBtn").removeClass("active")
            $("#ingredientCategoryAllTimeBtn").removeClass("active")

            const endDate = new Date()
            const startDate = new Date()
            startDate.setDate(startDate.getDate() - 30)

            fetchIngredientCategoryData(startDate, endDate)
          })

          // Thiết lập sự kiện cho nút tất cả
          $("#ingredientCategoryAllTimeBtn").on("click", function () {
            $(this).addClass("active")
            $("#ingredientCategory7DaysBtn").removeClass("active")
            $("#ingredientCategory30DaysBtn").removeClass("active")

            fetchIngredientCategoryData(null, null)
          })
        }

        function fetchIngredientCategoryData(startDate = null, endDate = null) {
          // Hiển thị trạng thái đang tải
          $("#ingredientCategoryChartLoading").show()
          $("#ingredientCategoryChartError").hide()

          // Chuẩn bị tham số
          const params = {
            topCategories: 8, // Lấy top 8 nhóm món
          }

          // Thêm tham số ngày nếu có
          if (startDate) {
            params.startDate = formatDateDB(startDate)
          }
          if (endDate) {
            params.endDate = formatDateDB(endDate)
          }

          // Gọi API để lấy dữ liệu biểu đồ
          $.ajax({
            url: systemURL + "statistics/api/ingredient-categories",
            type: "GET",
            data: params,
            success: (response) => {
              if (response.status == 200 && response.data) {
                // Cập nhật biểu đồ với dữ liệu mới
                window.ingredientCategoryChart.updateOptions({
                  series: response.data[0].values,
                  labels: response.data[0].labels,
                  colors: response.data[0].colors,
                })

                // Cập nhật tổng số món
                $("#totalIngredientsSold").text(response.data[0].total.toLocaleString("vi-VN"))

                // Cập nhật bảng chi tiết
                updateIngredientCategoryTable(response.data[0])
              } else {
                showIngredientChartError()
              }

              // Ẩn trạng thái đang tải
              $("#ingredientCategoryChartLoading").hide()
            },
            error: (xhr, status, error) => {
              console.error("Lỗi khi gọi API:", error)
              showIngredientChartError()

              // Ẩn trạng thái đang tải
              $("#ingredientCategoryChartLoading").hide()
            },
          })
        }

        function updateIngredientCategoryTable(data) {
          const tableBody = $("#ingredientCategoryTableBody")
          tableBody.empty()

          // Tính tổng số lượng
          const total = data.values.reduce((sum, value) => sum + value, 0)

          // Thêm dữ liệu vào bảng
          data.labels.forEach((label, index) => {
            const value = data.values[index]
            const percentage = ((value / total) * 100).toFixed(1)
            const color = data.colors[index]

            const row = `
              <tr>
                <td>
                  <div class="d-flex align-items-center">
                    <div class="color-indicator" style="background-color: ${color}"></div>
                    <span>${label}</span>
                  </div>
                </td>
                <td class="text-end">${value.toLocaleString("vi-VN")}</td>
                <td class="text-end">${percentage}%</td>
              </tr>
            `

            tableBody.append(row)
          })
        }

        function formatDateDB(date) {
          return date.toISOString().split("T")[0]
        }

        function showIngredientChartError() {
          // Hiển thị thông báo lỗi
          $("#ingredientCategoryChartError").show()

          // Tự động ẩn sau 5 giây
          setTimeout(() => {
            $("#ingredientCategoryChartError").fadeOut()
          }, 5000)
        }

                function loadPopularDishes() {
          $.ajax({
            url: systemURL + "Dish/api/popular",
            type: "GET",
            data: {
              count: 5,
            },
            success: (response) => {
              if (response.status == 200 && response.data) {
                renderPopularDishes(response.data[0])
              } else {
                showErrorDish("Không thể tải dữ liệu món ăn bán chạy: " + response.message)
              }
            },
            error: (xhr, status, error) => {
              showErrorDish("Lỗi kết nối đến máy chủ. Vui lòng thử lại sau.")
              console.error("Error loading popular dishes:", error)
            },
          })
        }

        function renderPopularDishes(dishes) {
          const container = $("#popularDish")
          container.empty()

          if (!dishes || dishes.length === 0) {
            container.html('<div class="alert alert-info">Không có dữ liệu món ăn bán chạy.</div>')
            return
          }

          // Hiển thị từng món ăn bán chạy
          dishes.forEach((dish) => {
            const dishElement = `
                    <div class="popular-dish">
                        <div class="popular-dish-image">
                            <img src="${systemURL}${dish.photo || "https://via.placeholder.com/60x60"}" alt="${dish.dishName}">
                        </div>
                        <div class="popular-dish-info">
                            <div class="popular-dish-name">${dish.dishName}</div>
                            <div class="popular-dish-category">${dish.categoryName}</div>
                            <div class="popular-dish-stats">
                                <div class="popular-dish-price">${formatCurrencyDB(dish.price)}</div>
                                <div class="popular-dish-sales">Đã bán: ${dish.salesCount} trong tháng</div>
                            </div>
                        </div>
                    </div>
                `

            container.append(dishElement)
          })
        }


        function openPopularDishesModal() {
          // Kiểm tra xem modal đã tồn tại chưa
          if ($("#popularDishesModal").length === 0) {
            // Tạo modal nếu chưa tồn tại
            const modalHtml = `
                    <div class="modal fade" id="popularDishesModal" tabindex="-1" aria-labelledby="popularDishesModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-xl">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="popularDishesModalLabel">Danh sách món ăn và số lượng bán ra</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="table-responsive">
                                        <table id="dishesDataTable" class="table table-striped table-bordered" style="width:100%">
                                            <thead>
                                                <tr>
                                                    <th>Mã món</th>
                                                    <th>Tên món</th>
                                                    <th>Danh mục</th>
                                                    <th>Giá</th>
                                                    <th>Số lượng bán ra</th>
                                                    <th>Ngày tạo</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Dữ liệu sẽ được thêm bằng DataTables -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `

            $("body").append(modalHtml)
          }

          // Khởi tạo DataTable nếu chưa được khởi tạo
          if (!$.fn.DataTable.isDataTable("#dishesDataTable")) {
            initDishesDataTable()
          } else {
            // Nếu DataTable đã được khởi tạo, reload dữ liệu
            $("#dishesDataTable").DataTable().ajax.reload()
          }

          // Hiển thị modal
          var popularDishesModal = new bootstrap.Modal(document.getElementById("popularDishesModal"))
          popularDishesModal.show()
        }

        function initDishesDataTable() {
          dishTable = $('#dishesDataTable').DataTable({
                processing: true,
                serverSide: true,
                paging: true,
                searching: { regex: true },
                "oLanguage": {
                    "sUrl": "/js/Vietnamese.json"
                },
                ajax: {
                    url: systemURL + "dish/api/list-popular-server-side",
                    type: "POST",
                    contentType: "application/json",

                    dataType: "json",
                    // beforeSend: function(xhr) {
                    // 	xhr.setRequestHeader('Authorization', 'Bearer ' + localStorage.token);
                    // },
                    data: function (d) {
                        d.searchAll = "";
                        return JSON.stringify(d);
                    }
                },
                columns: [
              { data: "dishCode" },
              { data: "dishName" },
              { data: "categoryName" },
              {
                data: "price",
                render: (data) => formatCurrencyDB(data),
              },
              { data: "salesCount" },
              {
                data: "createdTime",
                render: (data) => formatDateDB(new Date(data)),
              },
            ],
            order: [[4, 1]], // Sắp xếp theo số lượng bán ra giảm dần
           columnDefs: [
                        { targets: "no-sort", orderable: false },
                        { targets: "no-search", searchable: false },
                        { orderable: false, targets: [-1, 0] },
                    ],
                    aLengthMenu: [
                        [10, 25, 50, 100],
                        [10, 25, 50, 100]
                    ]
          })
        }

                function formatCurrencyDB(amount) {
          return new Intl.NumberFormat("vi-VN", { style: "currency", currency: "VND" }).format(amount)
        }

        function showErrorDish(message) {
          const container = $("#popularDish")
          container.html(`
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    ${message}
                </div>
                <button class="btn btn-primary mt-3" onclick="loadPopularDishes()">
                    <i class="fas fa-sync-alt me-2"></i> Thử lại
                </button>
            `)
        }

        // Ingredient Category Chart
        var ingredientCategoryOptions = {
            series: [{
                name: 'Tồn kho',
                data: [88, 60, 28, 48, 120]
            }],
            chart: {
                type: 'bar',
                height: 350,
                toolbar: {
                    show: false
                }
            },
            plotOptions: {
                bar: {
                    horizontal: false,
                    columnWidth: '55%',
                    borderRadius: 5,
                    dataLabels: {
                        position: 'top',
                    },
                }
            },
            dataLabels: {
                enabled: false
            },
            stroke: {
                show: true,
                width: 2,
                colors: ['transparent']
            },
            xaxis: {
                categories: ['Thịt', 'Rau củ', 'Hải sản', 'Gia vị', 'Khác'],
            },
            yaxis: {
                title: {
                    text: 'Số lượng (kg/lít/đơn vị)'
                }
            },
            fill: {
                opacity: 1,
                colors: ['#4361ee']
            },
            tooltip: {
                y: {
                    formatter: function(val) {
                        return val + " đơn vị";
                    }
                }
            }
        };

        var ingredientCategoryChart = new ApexCharts(document.querySelector("#ingredientCategoryChart"), ingredientCategoryOptions);
        ingredientCategoryChart.render();
 
        // Fake API Data
        const fakeApiData = {
            // API mẫu cho thống kê tổng quan
            getDashboardStats: {
                endpoint: '/api/dashboard/stats',
                method: 'GET',
                params: {
                    startDate: '2023-05-01',
                    endDate: '2023-05-15'
                },
                response: {
                    revenue: {
                        today: 12580000,
                        yesterday: 10940000,
                        percentChange: 15
                    },
                    orders: {
                        today: 85,
                        yesterday: 79,
                        percentChange: 8
                    },
                    customers: {
                        today: 210,
                        yesterday: 188,
                        percentChange: 12
                    },
                    inventory: {
                        totalItems: 45,
                        lowStockItems: 3
                    }
                }
            },

            // API mẫu cho biểu đồ doanh thu
            getRevenueData: {
                endpoint: '/api/dashboard/revenue',
                method: 'GET',
                params: {
                    period: 'week', // 'week', 'month', 'year'
                    startDate: '2023-05-09',
                    endDate: '2023-05-15'
                },
                response: {
                    labels: ['T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'CN'],
                    revenue: [11500000, 9800000, 12300000, 10500000, 14200000, 15800000, 12580000],
                    orders: [65, 58, 72, 63, 78, 82, 85]
                }
            },

            // API mẫu cho danh sách món ăn bán chạy
            getPopularDishes: {
                endpoint: '/api/dashboard/popular-dishes',
                method: 'GET',
                params: {
                    limit: 5,
                    period: 'month' // 'day', 'week', 'month', 'year'
                },
                response: {
                    dishes: [
                        {
                            id: 1,
                            name: 'Bún bò Huế',
                            category: 'Món chính',
                            price: 75000,
                            sales: 128,
                            imageUrl: 'https://via.placeholder.com/60x60'
                        },
                        {
                            id: 2,
                            name: 'Cơm tấm sườn bì chả',
                            category: 'Món chính',
                            price: 85000,
                            sales: 112,
                            imageUrl: 'https://via.placeholder.com/60x60'
                        },
                        {
                            id: 3,
                            name: 'Gỏi cuốn tôm thịt',
                            category: 'Khai vị',
                            price: 65000,
                            sales: 95,
                            imageUrl: 'https://via.placeholder.com/60x60'
                        },
                        {
                            id: 4,
                            name: 'Chè thái',
                            category: 'Tráng miệng',
                            price: 35000,
                            sales: 87,
                            imageUrl: 'https://via.placeholder.com/60x60'
                        },
                        {
                            id: 5,
                            name: 'Trà đào cam sả',
                            category: 'Đồ uống',
                            price: 45000,
                            sales: 76,
                            imageUrl: 'https://via.placeholder.com/60x60'
                        }
                    ]
                }
            },

            // API mẫu cho danh sách tồn kho
            getInventory: {
                endpoint: '/api/inventory/list',
                method: 'GET',
                params: {
                    page: 1,
                    limit: 10,
                    search: '',
                    category: '' // 'meat', 'vegetables', 'seafood', 'spices', 'other'
                },
                response: {
                    total: 45,
                    page: 1,
                    limit: 10,
                    items: [
                        {
                            id: 1,
                            code: 'SP001',
                            name: 'Thịt bò',
                            category: 'Thịt',
                            quantity: 45,
                            unit: 'kg',
                            status: 'in-stock', // 'in-stock', 'low-stock', 'out-of-stock'
                            lastUpdated: '2023-05-15T08:30:00'
                        },
                        {
                            id: 2,
                            code: 'SP002',
                            name: 'Thịt gà',
                            category: 'Thịt',
                            quantity: 28,
                            unit: 'kg',
                            status: 'in-stock',
                            lastUpdated: '2023-05-15T11:30:00'
                        },
                        // ... more items
                    ]
                }
            },

            // API mẫu cho danh sách nhân viên
            getStaff: {
                endpoint: '/api/staff/list',
                method: 'GET',
                params: {
                    page: 1,
                    limit: 10,
                    search: '',
                    position: '' // 'manager', 'chef', 'waiter', 'cashier'
                },
                response: {
                    total: 15,
                    page: 1,
                    limit: 10,
                    staff: [
                        {
                            id: 1,
                            name: 'Nguyễn Văn A',
                            position: 'Quản lý',
                            avatar: ' ',
                            performance: 95,
                            orders: 28,
                            status: 'active'
                        },
                        {
                            id: 2,
                            name: 'Trần Thị B',
                            position: 'Đầu bếp',
                            avatar: ' ',
                            performance: 92,
                            dishes: 45,
                            status: 'active'
                        },
                        // ... more staff
                    ]
                }
            },

            // API mẫu cho danh sách nhà cung cấp
            getSuppliers: {
                endpoint: '/api/suppliers/list',
                method: 'GET',
                params: {
                    page: 1,
                    limit: 10,
                    search: '',
                    category: '' // 'meat', 'vegetables', 'seafood', 'spices', 'other'
                },
                response: {
                    total: 8,
                    page: 1,
                    limit: 10,
                    suppliers: [
                        {
                            id: 1,
                            name: 'Thịt sạch ABC',
                            category: 'Thịt tươi sống',
                            logo: 'https://via.placeholder.com/50x50',
                            phone: '0987654321',
                            email: 'contact@thitsachabc.com',
                            address: '123 Đường Lê Lợi, Quận 1, TP.HCM',
                            status: 'active'
                        },
                        {
                            id: 2,
                            name: 'Rau sạch 123',
                            category: 'Rau củ quả',
                            logo: 'https://via.placeholder.com/50x50',
                            phone: '0123456789',
                            email: 'info@rausach123.com',
                            address: '456 Đường Nguyễn Huệ, Quận 1, TP.HCM',
                            status: 'active'
                        },
                        // ... more suppliers
                    ]
                }
            }
        };

        function loadRecentStockTransactions() {
            $.ajax({
                url: systemURL + "stockTransactionDetail/api/RecentTrans?number=5",
                type: "GET",
                dataType: "json",
                success: function (response) {
                    const content = $('#recent-transactions-content');
                    content.empty();

                    if (response && response.data && response.data.length > 0) {
                        response.data.forEach(item => {
                            const html = `
                            <div class="inventory-movement">
                                <div class="inventory-movement-icon ${item.cssClass}">
                                    <i class="fas ${item.icon}"></i>
                                </div>
                                <div class="inventory-movement-info">
                                    <div class="inventory-movement-title">${item.transactionType}: ${item.ingredientName}</div>
                                    <div class="inventory-movement-details">
                                        <span>${item.createdBy}</span> •
                                        <span>${moment(item.createdTime).format("DD/MM/YYYY HH:mm")}</span>
                                    </div>
                                </div>
                                <div class="inventory-movement-quantity ${item.cssClass}">
                                    ${(item.cssClass.includes('out') ? '-' : '+')}${item.quantity}
                                </div>
                            </div>`;
                            content.append(html);
                        });
                    } else {
                        content.append("<p class='text-muted'>Không có giao dịch gần đây.</p>");
                    }
                },
                error: function () {
                    $('#recent-transactions-content').html("<p class='text-danger'>Lỗi khi tải dữ liệu.</p>");
                }
            });
        }

        function initStockTransactionDataTable() {
            $('#stockTransactionTable').DataTable({
                processing: true,
                serverSide: true,
                paging: true,
                searching: { regex: true },
                language: {
                    url: "/js/Vietnamese.json"
                },
                ajax: {
                    url: systemURL + "stockTransactionDetail/api/list-server-side-summary",
                    type: "POST",
                    contentType: "application/json",
                    dataType: "json",
                    data: function (d) {
                        d.searchAll = "";
                        return JSON.stringify(d);
                    }
                },
                      columns: [
          {
            data: "transactionType",
            render: function (data, type, row) {
              const icon = row.icon || "fa-exchange-alt";
              const cssClass = row.cssClass.includes("out") ? "text-success" : "text-danger"
              return `<i class="fas ${icon} me-2 ${cssClass} font-weight-bold"></i><span  class="${cssClass} font-weight-bold">${data}</span>`;
            }
          },
          { data: "ingredientName" },
          { data: "createdBy" },
          {
            data: "createdTime",
            render: function (data) {
              return moment(data).format("DD/MM/YYYY HH:mm");
            }
          },
          {
            data: "quantity",
            render: function (data, type, row) {
              const sign = row.cssClass.includes("out") ? "-" : "+";
              const cls = row.cssClass.includes("out") ? "text-danger" : "text-success";
              return `<span class="${cls}">${sign}${data}</span>`;
            }
          }
        ],
        rowCallback: function (row, data) {
                  $(row).removeClass('bg-import bg-export bg-adjust');

                  if (data.transactionType.includes("Nhập")) {
                    $(row).addClass("bg-import");
                  } else if (data.transactionType.includes("Xuất")) {
                    $(row).addClass("bg-export");
                  } else {
                    $(row).addClass("bg-adjust");
                  }
        },
                order: [[3, "desc"]],
                columnDefs: [
                    { targets: "no-sort", orderable: false },
                    { targets: "no-search", searchable: false },
                ],
                aLengthMenu: [
                    [10, 25, 50, 100],
                    [10, 25, 50, 100]
                ]
            });
        }

        $('#view-all-stock-transactions').on('click', function () {
            $('#stockTransactionModal').modal('show');

            if (!$.fn.DataTable.isDataTable('#stockTransactionTable')) {
                initStockTransactionDataTable();
            } else {
                $('#stockTransactionTable').DataTable().ajax.reload();
            }
        });

    </script>
</div>
